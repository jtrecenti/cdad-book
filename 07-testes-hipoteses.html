<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.55">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>7&nbsp; Testes de hipóteses – Ciência de Dados Aplicada ao Direito II</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./08-correlacao-regressao.html" rel="next">
<link href="./06-probabilidade-cnormal.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./07-testes-hipoteses.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Testes de hipóteses</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Ciência de Dados Aplicada ao Direito II</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefácio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introdução</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-organizacao-dados-taxas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Organização de dados, frequências, proporções e taxas</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-medidas-posicao-variabilidade.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Medidas de posição e variabilidade</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-visualizacao-seaborn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Visualizações com seaborn</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-amostras-populacoes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Amostras e populações</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-probabilidade-cnormal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Probabilidade e curva normal</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-testes-hipoteses.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Testes de hipóteses</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-correlacao-regressao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Correlação e regressão</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-modelos-classificacao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Modelos de classificação</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-corporativo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Aplicações corporativas</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-openai.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Classificação de documentos usando OpenAI GPT-4o-mini</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./resumo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Resumo</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./refs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introdução" id="toc-introdução" class="nav-link active" data-scroll-target="#introdução"><span class="header-section-number">7.1</span> Introdução</a></li>
  <li><a href="#intervalos-de-confiança-como-testes-de-hipóteses" id="toc-intervalos-de-confiança-como-testes-de-hipóteses" class="nav-link" data-scroll-target="#intervalos-de-confiança-como-testes-de-hipóteses"><span class="header-section-number">7.2</span> Intervalos de confiança como testes de hipóteses</a>
  <ul class="collapse">
  <li><a href="#revisão" id="toc-revisão" class="nav-link" data-scroll-target="#revisão"><span class="header-section-number">7.2.1</span> Revisão</a></li>
  <li><a href="#intervalo-de-confiança-para-proporção" id="toc-intervalo-de-confiança-para-proporção" class="nav-link" data-scroll-target="#intervalo-de-confiança-para-proporção"><span class="header-section-number">7.2.2</span> Intervalo de confiança para proporção</a></li>
  </ul></li>
  <li><a href="#testes-de-hipóteses" id="toc-testes-de-hipóteses" class="nav-link" data-scroll-target="#testes-de-hipóteses"><span class="header-section-number">7.3</span> Testes de hipóteses</a>
  <ul class="collapse">
  <li><a href="#definição" id="toc-definição" class="nav-link" data-scroll-target="#definição"><span class="header-section-number">7.3.1</span> Definição</a></li>
  <li><a href="#na-prática" id="toc-na-prática" class="nav-link" data-scroll-target="#na-prática"><span class="header-section-number">7.3.2</span> Na prática</a></li>
  <li><a href="#teste-para-duas-proporções" id="toc-teste-para-duas-proporções" class="nav-link" data-scroll-target="#teste-para-duas-proporções"><span class="header-section-number">7.3.3</span> Teste para duas proporções</a></li>
  <li><a href="#teste-para-várias-proporções" id="toc-teste-para-várias-proporções" class="nav-link" data-scroll-target="#teste-para-várias-proporções"><span class="header-section-number">7.3.4</span> Teste para várias proporções</a></li>
  <li><a href="#teste-de-médias" id="toc-teste-de-médias" class="nav-link" data-scroll-target="#teste-de-médias"><span class="header-section-number">7.3.5</span> Teste de médias</a></li>
  <li><a href="#extra-simulação" id="toc-extra-simulação" class="nav-link" data-scroll-target="#extra-simulação"><span class="header-section-number">7.3.6</span> (extra) Simulação</a></li>
  <li><a href="#extra-por-que-usamos-t-student" id="toc-extra-por-que-usamos-t-student" class="nav-link" data-scroll-target="#extra-por-que-usamos-t-student"><span class="header-section-number">7.3.7</span> (extra) por que usamos t-student?</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Testes de hipóteses</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div id="cell-1" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats <span class="im">as</span> stats</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-2" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>camaras <span class="op">=</span> pd.read_csv(<span class="st">'https://github.com/jtrecenti/main-cdad2/releases/download/data/camaras.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="introdução" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="introdução"><span class="header-section-number">7.1</span> Introdução</h2>
<p>Neste documento, vamos formalizar os conceitos de intervalo de confiança e testes de hipóteses. Vamos começar com o intervalo de confiança.</p>
</section>
<section id="intervalos-de-confiança-como-testes-de-hipóteses" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="intervalos-de-confiança-como-testes-de-hipóteses"><span class="header-section-number">7.2</span> Intervalos de confiança como testes de hipóteses</h2>
<section id="revisão" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="revisão"><span class="header-section-number">7.2.1</span> Revisão</h3>
<p>O intervalo de confiança é utilizado para criar estimativas intervalares. Quando vemos uma pesquisa que diz que uma média é 50 +/- 5, estamos vendo um intervalo de confiança. O intervalo de confiança é uma faixa de valores que contém o valor real com uma certa probabilidade. Por exemplo, um intervalo de confiança de 95% significa que, se repetirmos o experimento muitas vezes, é esperado que 95% dos intervalos de confiança conterão o valor real.</p>
<p>Não confunda o intervalo de confiança com a probabilidade do parâmetro estar dentro do intervalo. O parâmetro é um valor fixo e não é aleatório. O que é aleatório é o intervalo de confiança, pois é baseado em estimadores amostrais, que são variáveis aleatórias.</p>
<p>Como vimos antes, quando nosso interesse é estimar a média de uma variável contínua, o intervalo de confiança é dado por:</p>
<p><span class="math display">\[
\bar X \pm z_{1-\alpha/2} \frac{S}{\sqrt n}
\]</span></p>
<p>Aqui, <span class="math inline">\(\bar X\)</span> é a média amostral, <span class="math inline">\(S\)</span> é o desvio padrão amostral, <span class="math inline">\(n\)</span> é o tamanho da amostra e <span class="math inline">\(z_{1-\alpha/2}\)</span> é o quantil da distribuição normal padrão. O valor de <span class="math inline">\(z_{1-\alpha/2}\)</span> é escolhido de acordo com o nível de confiança desejado. Por exemplo, para um nível de confiança de 95%, temos <span class="math inline">\(\alpha = 0.05\)</span> e <span class="math inline">\(z_{1-\alpha/2} = 1.96\)</span>.</p>
<p>Após observar os dados, trocamos as letras maiúsculas para minúsculas, denotando que estamos saindo do mundo das variáveis aleatórias (as funções que retornam números) para os números em si. Assim, o intervalo de confiança é escrito como:</p>
<p><span class="math display">\[
\bar x \pm z_{1-\alpha/2} \frac{s}{\sqrt n}
\]</span></p>
<section id="aplicação-no-python" class="level4" data-number="7.2.1.1">
<h4 data-number="7.2.1.1" class="anchored" data-anchor-id="aplicação-no-python"><span class="header-section-number">7.2.1.1</span> Aplicação no python</h4>
<p>No python, podemos calcular o intervalo de confiança fazendo as seguintes operações:</p>
<div id="cell-4" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>tempos <span class="op">=</span> camaras.tempo</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>media <span class="op">=</span> tempos.mean()</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>sd <span class="op">=</span> tempos.std()</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> stats.norm.ppf(<span class="fl">0.975</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">len</span>(tempos)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>vl_intervalo <span class="op">=</span> z <span class="op">*</span> sd <span class="op">/</span> np.sqrt(n)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>media <span class="op">-</span> vl_intervalo, media <span class="op">+</span> vl_intervalo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>(3.136057807684683, 3.221624914728558)</code></pre>
</div>
</div>
<p>Também é possível usar a função <code>norm.interval</code> do módulo <code>scipy.stats</code> para calcular o intervalo de confiança. Nessa função, o primeiro argumento é o nível de confiança, o segundo é a média amostral e o terceiro é o erro padrão (desvio padrão da amostra dividido pelo número de observações). O retorno é uma tupla com os limites inferior e superior do intervalo de confiança.</p>
<div id="cell-6" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>stats.norm.interval(confidence<span class="op">=</span><span class="fl">0.95</span>, loc<span class="op">=</span>media, scale<span class="op">=</span>stats.sem(tempos, nan_policy<span class="op">=</span><span class="st">'omit'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>(3.136055668346555, 3.221627054066686)</code></pre>
</div>
</div>
<p>Também é possível usar a função <code>t.interval</code> do módulo <code>scipy.stats</code> para calcular o intervalo de confiança. Nesse caso, o primeiro argumento é o nível de confiança, o segundo é o tamanho da amostra menos um, o terceiro é a média amostral e o quarto é o erro padrão.</p>
<div id="cell-8" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>stats.t.interval(confidence<span class="op">=</span><span class="fl">0.95</span>, df<span class="op">=</span>n<span class="op">-</span><span class="dv">1</span>, loc<span class="op">=</span>media, scale<span class="op">=</span>stats.sem(tempos, nan_policy<span class="op">=</span><span class="st">'omit'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>(3.136050488583062, 3.221632233830179)</code></pre>
</div>
</div>
<p>Existe uma pequena diferença entre fazer a conta na mão e fazer com a função <code>t.interval</code>. A função <code>t.interval</code> usa a distribuição t de Student no lugar da distribuição normal. A distribuição t é uma distribuição bem parecida com a distribuição normal, mas é mais achatada. Usamos a distribuição t por razões técnicas, que foram colocadas ao final da apostila por serem mais avançadas.</p>
</section>
</section>
<section id="intervalo-de-confiança-para-proporção" class="level3" data-number="7.2.2">
<h3 data-number="7.2.2" class="anchored" data-anchor-id="intervalo-de-confiança-para-proporção"><span class="header-section-number">7.2.2</span> Intervalo de confiança para proporção</h3>
<p>Na ciência de dados aplicada ao direito, é comum querermos estimar a proporção de um evento. Por exemplo, queremos saber a proporção de decisões favoráveis em um tipo de caso. Neste caso, também utilizamos o TCL para criar intervalos de confiança, afinal, a proporção é um tipo de média, mas de uma variável binária. Vimos anteriormente que a distribuição de probabilidades aplicável no caso de uma variável binária é a distribuição de Bernoulli, sendo que a soma de variáveis Bernoulli é uma variável com distribuição binomial.</p>
<p><strong>Nota histórica</strong>: a distribuição binomial é uma distribuição discreta (assume valores 0, 1, 2, 3 etc, já que ela é a soma de valores que valem 0 ou 1), enquanto a distribuição normal é uma distribuição contínua. No entanto, o TCL nos permite aproximar a distribuição binomial pela distribuição normal, desde que o tamanho da amostra seja grande. Historicamente, a aproximação da distribuição binomial pela distribuição normal foi feita por Abraham de Moivre em 1743, que descobriu que a distribuição binomial se aproxima da distribuição normal (que nem tinha uma definição clara na época) quando o número de tentativas é grande. Essa demonstração foi feita muito antes do TCL, que é um resultado mais geral.</p>
<p>Para fazer o intervalo de confiança para proporção, utilizamos o TCL, e, portanto, o z-score para criar o intervalo de confiança. O intervalo de confiança é dado por:</p>
<p><span class="math display">\[
\hat p \pm z_{1-\alpha/2} \sqrt{\frac{\hat p (1-\hat p)}{n}}
\]</span></p>
<p>Aqui, <span class="math inline">\(\hat p\)</span> é a proporção amostral, <span class="math inline">\(n\)</span> é o tamanho da amostra e <span class="math inline">\(z_{1-\alpha/2}\)</span> é o quantil da distribuição normal padrão. O valor de <span class="math inline">\(z_{1-\alpha/2}\)</span> é escolhido de acordo com o nível de confiança desejado. Por exemplo, para um nível de confiança de 95%, temos <span class="math inline">\(\alpha = 0.05\)</span> e <span class="math inline">\(z_{1-\alpha/2} = 1.96\)</span>.</p>
<p>Note que utilizamos o valor <span class="math inline">\(\hat p (1-\hat p)\)</span> no lugar de <span class="math inline">\(S\)</span>. Isso acontece porque a variância da distribuição de Bernoulli é dada por <span class="math inline">\(p (1 - p)\)</span>, fato que não vamos demostrar aqui. Então, substituímos o valor de <span class="math inline">\(p\)</span>, desconhecido, pelo valor de <span class="math inline">\(\hat p\)</span>, que é a estimativa amostral da proporção. Aqui também fazemos uso do Teorema de Slutsky para afirmar que a distribuição amostral da proporção seja aproximadamente normal.</p>
<p>Mas existe um segundo jeito de fazer intervalo de confiança para proporções. Esse jeito é baseado no valor máximo que a variância da proporção pode assumir. Vamos ver o gráfico dessa função:</p>
<div id="cell-11" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> variancia_bernoulli(p):</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> p <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> p)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>p_seq <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">200</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>plt.plot(p_seq, variancia_bernoulli(p_seq))</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>plt.axvline(<span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">'black'</span>, linestyle <span class="op">=</span> <span class="st">'--'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07-testes-hipoteses_files/figure-html/cell-7-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Veja que o valor máximo dessa função é 0.25. Isso ocorre porque a variância da proporção é máxima quando a proporção é 0.5. Com isso, podemos fazer um intervalo de confiança mais <strong>conservador</strong>, que é dado por:</p>
<p><span class="math display">\[
\hat p \pm z_{1-\alpha/2} \sqrt{\frac{0.25}{n}} = \hat p \pm \frac{z_{1-\alpha/2}}{2\sqrt n}
\]</span></p>
<section id="aplicação-no-python-1" class="level4" data-number="7.2.2.1">
<h4 data-number="7.2.2.1" class="anchored" data-anchor-id="aplicação-no-python-1"><span class="header-section-number">7.2.2.1</span> Aplicação no python</h4>
<p>Agora, vamos ver os intervalos de confiança para proporção no python:</p>
<div id="cell-13" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>desfavoravel <span class="op">=</span> camaras.decisao <span class="op">==</span> <span class="st">'Negaram'</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>p_hat <span class="op">=</span> desfavoravel.mean()</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>intervalo_otimista <span class="op">=</span> stats.norm.ppf(<span class="fl">0.975</span>) <span class="op">*</span> np.sqrt(variancia_bernoulli(p_hat) <span class="op">/</span> <span class="bu">len</span>(camaras))</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>intervalo_conservador <span class="op">=</span> stats.norm.ppf(<span class="fl">0.975</span>) <span class="op">/</span> <span class="dv">2</span> <span class="op">/</span> np.sqrt(<span class="bu">len</span>(camaras))</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(p_hat <span class="op">-</span> intervalo_otimista, p_hat <span class="op">+</span> intervalo_otimista)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(p_hat <span class="op">-</span> intervalo_conservador, p_hat <span class="op">+</span> intervalo_conservador)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.5175147983958988 0.5370852016041012
0.5175001800772997 0.5370998199227003</code></pre>
</div>
</div>
<p>Como a amostra é grande, os intervalos otimista e conservador são praticamente iguais. Vamos ver com uma amostra pequena:</p>
<div id="cell-15" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>desfavoravel <span class="op">=</span> camaras.sample(<span class="dv">30</span>, random_state<span class="op">=</span><span class="dv">42</span>).decisao <span class="op">==</span> <span class="st">'Negaram'</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>p_hat <span class="op">=</span> desfavoravel.mean()</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>intervalo_otimista <span class="op">=</span> stats.norm.ppf(<span class="fl">0.975</span>) <span class="op">*</span> np.sqrt(variancia_bernoulli(p_hat) <span class="op">/</span> <span class="bu">len</span>(camaras))</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>intervalo_conservador <span class="op">=</span> stats.norm.ppf(<span class="fl">0.975</span>) <span class="op">/</span> <span class="dv">2</span> <span class="op">/</span> np.sqrt(<span class="bu">len</span>(camaras))</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(p_hat <span class="op">-</span> intervalo_otimista, p_hat <span class="op">+</span> intervalo_otimista)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(p_hat <span class="op">-</span> intervalo_conservador, p_hat <span class="op">+</span> intervalo_conservador)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.6574273078376688 0.6759060254956645
0.6568668467439663 0.6764664865893669</code></pre>
</div>
</div>
<p>Ainda assim, os intervalos são bem próximos. Isso ocorre porque a proporção observada é próxima a 0.5, então o intervalo conservador fica parecido com o otimista. Ao estudar uma informação mais rara, como a probabilidade de maioria nas decisões colegiadas, temos:</p>
<div id="cell-17" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>maioria <span class="op">=</span> camaras.sample(<span class="dv">30</span>, random_state<span class="op">=</span><span class="dv">3</span>).unanimidade <span class="op">==</span> <span class="st">'Maioria'</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>p_hat <span class="op">=</span> maioria.mean()</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>intervalo_otimista <span class="op">=</span> stats.norm.ppf(<span class="fl">0.975</span>) <span class="op">*</span> np.sqrt(variancia_bernoulli(p_hat) <span class="op">/</span> <span class="bu">len</span>(camaras))</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>intervalo_conservador <span class="op">=</span> stats.norm.ppf(<span class="fl">0.975</span>) <span class="op">/</span> <span class="dv">2</span> <span class="op">/</span> np.sqrt(<span class="bu">len</span>(camaras))</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(p_hat <span class="op">-</span> intervalo_otimista, p_hat <span class="op">+</span> intervalo_otimista)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(p_hat <span class="op">-</span> intervalo_conservador, p_hat <span class="op">+</span> intervalo_conservador)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.029815090309067926 0.03685157635759874
0.02353351341063306 0.043133153256033605</code></pre>
</div>
</div>
<p>Agora, vamos às funções mais diretas do python, que nos dão o intervalo de confiança para proporção. Aqui, não tem muito como fugir do cálculo da variância da Bernoulli.</p>
<div id="cell-19" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>ic_otimista <span class="op">=</span> stats.norm.interval(confidence<span class="op">=</span><span class="fl">0.95</span>, loc<span class="op">=</span>p_hat, scale<span class="op">=</span>np.sqrt(variancia_bernoulli(p_hat) <span class="op">/</span> <span class="bu">len</span>(camaras)))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>ic_conservador <span class="op">=</span> stats.norm.interval(confidence<span class="op">=</span><span class="fl">0.95</span>, loc<span class="op">=</span>p_hat, scale<span class="op">=</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">/</span>np.sqrt(<span class="bu">len</span>(camaras)))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ic_otimista)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ic_conservador)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(0.029815090309067926, 0.03685157635759874)
(0.02353351341063306, 0.043133153256033605)</code></pre>
</div>
</div>
<p>Até existe outra biblioteca, <code>statsmodels</code>, que faz o cálculo de intervalo de confiança para proporção, mas ela pode ficar para um curso mais avançado.</p>
</section>
</section>
</section>
<section id="testes-de-hipóteses" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="testes-de-hipóteses"><span class="header-section-number">7.3</span> Testes de hipóteses</h2>
<p>O teste de hipótese busca responder à seguinte pergunta: há evidências suficientes nos dados para fazer uma afirmação sobre a população? Por exemplo, se observarmos que as taxas de recursos negados em uma câmara é 67,8% e em outra câmara é 70,4%, podemos afirmar que a primeira câmara nega mais casos? Ou essa diferença é devida ao acaso?</p>
<p>Vamos ver esse exemplo no python:</p>
<div id="cell-22" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>exemplos_camaras <span class="op">=</span> [<span class="st">'03ª Câmara de Direito Criminal'</span>, <span class="st">'08ª Câmara de Direito Criminal'</span>]</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>camaras_filtrado <span class="op">=</span> (</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  camaras</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  .query(<span class="st">'polo_mp == "Passivo"'</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  .query(<span class="st">'camara == @exemplos_camaras'</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  .assign(negaram <span class="op">=</span> <span class="kw">lambda</span> x: x.decisao <span class="op">==</span> <span class="st">'Negaram'</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>proporcoes <span class="op">=</span> (</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  camaras_filtrado</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  .groupby(<span class="st">'camara'</span>)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  .agg(n <span class="op">=</span> (<span class="st">'decisao'</span>, <span class="bu">len</span>), p <span class="op">=</span> (<span class="st">'negaram'</span>, <span class="st">'mean'</span>))</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  .reset_index(names<span class="op">=</span><span class="st">'camara'</span>)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>proporcoes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">camara</th>
<th data-quarto-table-cell-role="th">n</th>
<th data-quarto-table-cell-role="th">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>03ª Câmara de Direito Criminal</td>
<td>528</td>
<td>0.678030</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>08ª Câmara de Direito Criminal</td>
<td>635</td>
<td>0.703937</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Uma forma de resolver esse problema é calculando o intervalo de confiança para cada uma das proporções e verificando se os intervalos se sobrepõem. Se eles não se sobrepõem, podemos afirmar que as proporções são diferentes. Se eles se sobrepõem, não podemos afirmar nada. Vamos calcular usando o intervalo otimista:</p>
<div id="cell-24" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>proporcoes_com_ic <span class="op">=</span> (</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  proporcoes</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  .assign(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    int_otimista <span class="op">=</span> <span class="kw">lambda</span> x: stats.norm.ppf(<span class="fl">0.975</span>) <span class="op">*</span> np.sqrt((x.p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x.p)) <span class="op">/</span> x.n),</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    p_min <span class="op">=</span> <span class="kw">lambda</span> x: x.p <span class="op">-</span> x.int_otimista,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    p_max <span class="op">=</span> <span class="kw">lambda</span> x: x.p <span class="op">+</span> x.int_otimista</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>proporcoes_com_ic</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">camara</th>
<th data-quarto-table-cell-role="th">n</th>
<th data-quarto-table-cell-role="th">p</th>
<th data-quarto-table-cell-role="th">int_otimista</th>
<th data-quarto-table-cell-role="th">p_min</th>
<th data-quarto-table-cell-role="th">p_max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>03ª Câmara de Direito Criminal</td>
<td>528</td>
<td>0.678030</td>
<td>0.039853</td>
<td>0.638177</td>
<td>0.717884</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>08ª Câmara de Direito Criminal</td>
<td>635</td>
<td>0.703937</td>
<td>0.035508</td>
<td>0.668430</td>
<td>0.739445</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-25" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>sns.pointplot(data <span class="op">=</span> camaras_filtrado, x <span class="op">=</span> <span class="st">'camara'</span>, y <span class="op">=</span> <span class="st">'negaram'</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>plt.axhline(<span class="fl">0.69</span>, color<span class="op">=</span><span class="st">'gray'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07-testes-hipoteses_files/figure-html/cell-14-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><strong>Obs</strong>: O seaborn faz o cálculo do intervalo de confiança automaticamente, logo não precisamos colocar os valores calculados anteriormente. Mas é possível ver que o resultado é o mesmo.</p>
<p>Note que os intervalos se sobrepõem, então, estatisticamente, não podemos afirmar que as proporções são diferentes.</p>
<p>Agora vamos ver um exemplo com outras câmaras.</p>
<div id="cell-27" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>exemplos_camaras <span class="op">=</span> [<span class="st">'04ª Câmara de Direito Criminal'</span>, <span class="st">'08ª Câmara de Direito Criminal'</span>]</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>camaras_filtrado <span class="op">=</span> (</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  camaras</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  .query(<span class="st">'polo_mp == "Passivo"'</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  .query(<span class="st">'camara == @exemplos_camaras'</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  .assign(negaram <span class="op">=</span> <span class="kw">lambda</span> x: x.decisao <span class="op">==</span> <span class="st">'Negaram'</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>proporcoes <span class="op">=</span> (</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  camaras_filtrado</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  .groupby(<span class="st">'camara'</span>)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  .agg(n <span class="op">=</span> (<span class="st">'decisao'</span>, <span class="bu">len</span>), p <span class="op">=</span> (<span class="st">'negaram'</span>, <span class="st">'mean'</span>))</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  .reset_index(names<span class="op">=</span><span class="st">'camara'</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>proporcoes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">camara</th>
<th data-quarto-table-cell-role="th">n</th>
<th data-quarto-table-cell-role="th">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>04ª Câmara de Direito Criminal</td>
<td>534</td>
<td>0.872659</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>08ª Câmara de Direito Criminal</td>
<td>635</td>
<td>0.703937</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Agora, as proporções estão bem distantes. Vamos calcular o intervalo de confiança para essas proporções:</p>
<div id="cell-29" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>proporcoes_com_ic <span class="op">=</span> (</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  proporcoes</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  .assign(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    int_otimista <span class="op">=</span> <span class="kw">lambda</span> x: stats.norm.ppf(<span class="fl">0.975</span>) <span class="op">*</span> np.sqrt((x.p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x.p)) <span class="op">/</span> x.n),</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    p_min <span class="op">=</span> <span class="kw">lambda</span> x: x.p <span class="op">-</span> x.int_otimista,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    p_max <span class="op">=</span> <span class="kw">lambda</span> x: x.p <span class="op">+</span> x.int_otimista</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>proporcoes_com_ic</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">camara</th>
<th data-quarto-table-cell-role="th">n</th>
<th data-quarto-table-cell-role="th">p</th>
<th data-quarto-table-cell-role="th">int_otimista</th>
<th data-quarto-table-cell-role="th">p_min</th>
<th data-quarto-table-cell-role="th">p_max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>04ª Câmara de Direito Criminal</td>
<td>534</td>
<td>0.872659</td>
<td>0.028274</td>
<td>0.844385</td>
<td>0.900933</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>08ª Câmara de Direito Criminal</td>
<td>635</td>
<td>0.703937</td>
<td>0.035508</td>
<td>0.668430</td>
<td>0.739445</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Finalmente, vamos ver isso graficamente:</p>
<div id="cell-31" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>sns.pointplot(data <span class="op">=</span> camaras_filtrado, x <span class="op">=</span> <span class="st">'camara'</span>, y <span class="op">=</span> <span class="st">'negaram'</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>plt.axhline(<span class="fl">0.80</span>, color<span class="op">=</span><span class="st">'gray'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07-testes-hipoteses_files/figure-html/cell-17-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Nesse caso, então, concluímos que as proporções são estatisticamente diferentes.</p>
<p>O que acabamos de fazer intuitivamente é o que chamamos de <strong>teste de hipótese de diferença de médias</strong>. No caso, aplicado para proporções. O teste de hipótese é uma forma de formalizar e generalizar a pergunta que fizemos anteriormente. Vamos ver como fazer isso.</p>
<section id="definição" class="level3" data-number="7.3.1">
<h3 data-number="7.3.1" class="anchored" data-anchor-id="definição"><span class="header-section-number">7.3.1</span> Definição</h3>
<p>Um fato curioso sobre o teste de hipóteses é que, geralmente, quando introduzimos o tema, usamos um exemplo jurídico. Isso ocorre porque o teste de hipóteses é uma forma de gerenciar os erros nas tomadas de decisão em ambientes de incerteza, e a tomada de decisão é o que os juízes fazem. Vamos ver esse exemplo, que é o exemplo do julgamento de um réu.</p>
<p>Quando fazemos um teste de hipóteses, estamos tentando decidir entre duas hipóteses: a hipótese nula (<span class="math inline">\(H_0\)</span>) e a hipótese alternativa (<span class="math inline">\(H_1\)</span>). A hipótese nula é a hipótese que queremos rejeitar, enquanto a hipótese alternativa é a hipótese que queremos aceitar. No exemplo do julgamento de um réu, a hipótese nula é que o réu é inocente, enquanto a hipótese alternativa é que o réu é culpado.</p>
<p><strong>Dois tipos de erros</strong>. Quando fazemos um teste de hipóteses, podemos cometer dois tipos de erros: o <strong>erro do tipo I</strong> e o <strong>erro do tipo II</strong>. O erro do tipo I ocorre quando rejeitamos a hipótese nula quando ela é verdadeira. No exemplo do julgamento de um réu, seria condenar um réu inocente. O erro do tipo II ocorre quando aceitamos a hipótese nula quando ela é falsa. No exemplo do julgamento de um réu, seria absolver um réu culpado.</p>
<p><img src="image.png" class="img-fluid"></p>
<p>Quando tomamos uma decisão, existem quatro possibilidades:</p>
<ol type="1">
<li><p><strong>Rejeitar a hipótese nula quando ela é verdadeira</strong>: isso é o erro do tipo I. A probabilidade de cometer esse erro é chamada de <strong>nível de significância</strong> e é denotada por <span class="math inline">\(\alpha\)</span>.</p></li>
<li><p><strong>Rejeitar a hipótese nula quando ela é falsa</strong>: isso é o que queremos fazer. A probabilidade de fazer isso é chamada de <strong>poder do teste</strong> e é denotada por <span class="math inline">\(1 - \beta\)</span>.</p></li>
<li><p><strong>Aceitar a hipótese nula quando ela é verdadeira</strong>: isso é o que queremos evitar. A probabilidade de fazer isso é chamada de <strong>nível de confiança</strong> e é denotada por <span class="math inline">\(1 - \alpha\)</span>.</p></li>
<li><p><strong>Aceitar a hipótese nula quando ela é falsa</strong>: isso é o erro do tipo II. A probabilidade de cometer esse erro é denotada por <span class="math inline">\(\beta\)</span>.</p></li>
</ol>
<p><strong>Definição</strong>. O teste de hipóteses é um procedimento estatístico que nos permite decidir entre duas hipóteses, a hipótese nula (<span class="math inline">\(H_0\)</span>) e a hipótese alternativa (<span class="math inline">\(H_1\)</span>), com base em uma amostra de dados. O teste de hipóteses é feito em três etapas:</p>
<ol type="1">
<li><p><strong>Formulação das hipóteses</strong>: formulamos a hipótese nula (<span class="math inline">\(H_0\)</span>) e a hipótese alternativa (<span class="math inline">\(H_1\)</span>). A hipótese nula é a hipótese que queremos rejeitar, enquanto a hipótese alternativa é a hipótese que queremos aceitar.</p></li>
<li><p><strong>Cálculo da estatística de teste</strong>: calculamos a estatística de teste, que é uma medida da diferença entre a amostra e a hipótese nula. A estatística de teste segue uma distribuição de probabilidades conhecida.</p></li>
<li><p><strong>Tomada de decisão</strong>: comparamos a estatística de teste com um valor crítico e decidimos se rejeitamos ou não a hipótese nula.</p></li>
</ol>
<p>O procedimento de teste mais conhecido é o teste de Neyman-Pearson, que busca minimizar a probabilidade de erro do tipo II, sujeito a um limite fixado para o erro do tipo I. O teste de Neyman-Pearson é um teste de hipóteses com regra de decisão baseada em um valor crítico.</p>
<p>O valor crítico é o valor que divide a região de rejeição da região de aceitação. A região de rejeição é a região onde rejeitamos a hipótese nula, enquanto a região de aceitação é a região onde aceitamos a hipótese nula. O valor crítico é escolhido de acordo com o nível de significância desejado. Por exemplo, para um nível de significância de 5%, o valor crítico da distribuição normal é 1,96, assim como vimos no z-score para intervalos de confiança.</p>
</section>
<section id="na-prática" class="level3" data-number="7.3.2">
<h3 data-number="7.3.2" class="anchored" data-anchor-id="na-prática"><span class="header-section-number">7.3.2</span> Na prática</h3>
<p>Na prática, entra em jogo o famoso valor-p (ou p-valor, dependendo do livro). O valor-p é a probabilidade de observar uma estatística de teste tão ou mais extrema quanto a observada, assumindo que a hipótese nula é verdadeira.</p>
<p>Intuitivamente, o valor-p é a probabilidade de encontrar um resultado que leva à rejeição da hipótese nula por mera coincidência. Em outras palavras: quando a hipótese nula é verdadeira (o réu é inocente), existem fatos que poderiam confundir o juiz ou juíza e levar ao erro, como circunstâncias complexas, preconceito, evidências falsas, entre outros. É isso que estamos chamando de “por coincidência”.</p>
<p>Se o valor-p for pequeno, seria muito arriscado afirmar que um efeito identificado (por exemplo, evidências para prender o réu), ocorreu ao acaso, por coincidência. Então rejeitamos a hipótese nula. No entanto, se o valor-p for grande, é bem possível que o resultado encontrado tenha acontecido por acaso, então dizemos que não há evidências para rejeitar a hipótese nula.</p>
</section>
<section id="teste-para-duas-proporções" class="level3" data-number="7.3.3">
<h3 data-number="7.3.3" class="anchored" data-anchor-id="teste-para-duas-proporções"><span class="header-section-number">7.3.3</span> Teste para duas proporções</h3>
<p>Vamos voltar ao exemplo da diferença entre a proporção de negados. Faremos um teste de hipóteses para cada situação (o caso em que os intervalos de confiança se sobrepõem e o caso em que os intervalos de confiança não se sobrepõem). Para cada um deles, faremos um exemplo com o cálculo do valor-p e outro exemplo com simulação, para entender o acontecimento “por acaso”.</p>
<div id="cell-34" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>exemplos_camaras <span class="op">=</span> [<span class="st">'03ª Câmara de Direito Criminal'</span>, <span class="st">'08ª Câmara de Direito Criminal'</span>]</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>camaras_filtrado <span class="op">=</span> (</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  camaras</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  .query(<span class="st">'polo_mp == "Passivo"'</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  .query(<span class="st">'camara == @exemplos_camaras'</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  .assign(negaram <span class="op">=</span> <span class="kw">lambda</span> x: x.decisao <span class="op">==</span> <span class="st">'Negaram'</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>proporcoes <span class="op">=</span> (</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  camaras_filtrado</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  .groupby(<span class="st">'camara'</span>)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  .agg(n <span class="op">=</span> (<span class="st">'decisao'</span>, <span class="bu">len</span>), n_negaram <span class="op">=</span> (<span class="st">'negaram'</span>, <span class="st">'sum'</span>), p <span class="op">=</span> (<span class="st">'negaram'</span>, <span class="st">'mean'</span>))</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  .reset_index(names<span class="op">=</span><span class="st">'camara'</span>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>proporcoes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">camara</th>
<th data-quarto-table-cell-role="th">n</th>
<th data-quarto-table-cell-role="th">n_negaram</th>
<th data-quarto-table-cell-role="th">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>03ª Câmara de Direito Criminal</td>
<td>528</td>
<td>358</td>
<td>0.678030</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>08ª Câmara de Direito Criminal</td>
<td>635</td>
<td>447</td>
<td>0.703937</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Nesse caso, nossas hipóteses são:</p>
<p><span class="math inline">\(H_0\)</span>: <span class="math inline">\(p_3 = p_8\)</span>, ou seja, as proporções são iguais</p>
<p><span class="math inline">\(H_1\)</span>: <span class="math inline">\(p_3 \neq p_8\)</span>, ou seja, as proporções são diferentes</p>
<p>Conectando com os conceitos anteriores: <span class="math inline">\(p_3\)</span> e <span class="math inline">\(p_8\)</span> são <strong>parâmetros</strong>, ou seja, a probabilidade de um caso ser negado em cada câmara.</p>
<section id="cálculo-do-valor-p" class="level4" data-number="7.3.3.1">
<h4 data-number="7.3.3.1" class="anchored" data-anchor-id="cálculo-do-valor-p"><span class="header-section-number">7.3.3.1</span> Cálculo do valor-p</h4>
<p>Para calcular o valor-p, utilizamos a função <code>chi2_contingency</code> do módulo <code>scipy.stats</code>. Essa é, na verdade, uma função para fazer o teste qui-quadrado de independência, mas podemos utilizá-la para fazer o teste de diferença de proporções. O retorno é uma tupla com a estatística de teste, o valor-p, o grau de liberdade e a tabela de contingência esperada.</p>
<div id="cell-36" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>contagens <span class="op">=</span> np.array(proporcoes[[<span class="st">'n_negaram'</span>, <span class="st">'n'</span>]])</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>prop_test <span class="op">=</span> stats.chi2_contingency(contagens)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>prop_test.pvalue</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">
<pre><code>0.7183537580673838</code></pre>
</div>
</div>
<p>Esse número significa que, se a hipótese nula fosse verdadeira, a probabilidade de observar uma diferença tão grande ou maior do que a observada seria de 72%. Como esse valor é bem alto, realmente parece que poderia ter acontecido por acaso. Por esse motivo, não rejeitamos a hipótese nula e podemos afirmar que as proporções são iguais. Note que essa é a mesma conclusão que chegamos ao calcular o intervalo de confiança.</p>
<p>No caso do teste comparando as câmaras 8 e 12, temos:</p>
<div id="cell-38" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>exemplos_camaras <span class="op">=</span> [<span class="st">'12ª Câmara de Direito Criminal'</span>, <span class="st">'08ª Câmara de Direito Criminal'</span>]</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>camaras_filtrado <span class="op">=</span> (</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  camaras</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  .query(<span class="st">'polo_mp == "Passivo"'</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  .query(<span class="st">'camara == @exemplos_camaras'</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  .assign(negaram <span class="op">=</span> <span class="kw">lambda</span> x: x.decisao <span class="op">==</span> <span class="st">'Negaram'</span>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>proporcoes <span class="op">=</span> (</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  camaras_filtrado</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  .groupby(<span class="st">'camara'</span>)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  .agg(n <span class="op">=</span> (<span class="st">'decisao'</span>, <span class="bu">len</span>), n_negaram <span class="op">=</span> (<span class="st">'negaram'</span>, <span class="st">'sum'</span>), p <span class="op">=</span> (<span class="st">'negaram'</span>, <span class="st">'mean'</span>))</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  .reset_index(names<span class="op">=</span><span class="st">'camara'</span>)</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>proporcoes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">camara</th>
<th data-quarto-table-cell-role="th">n</th>
<th data-quarto-table-cell-role="th">n_negaram</th>
<th data-quarto-table-cell-role="th">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>08ª Câmara de Direito Criminal</td>
<td>635</td>
<td>447</td>
<td>0.703937</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>12ª Câmara de Direito Criminal</td>
<td>521</td>
<td>103</td>
<td>0.197697</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>E agora o teste de hipótese:</p>
<div id="cell-40" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>contagens <span class="op">=</span> np.array(proporcoes[[<span class="st">'n_negaram'</span>, <span class="st">'n'</span>]])</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>prop_test <span class="op">=</span> stats.chi2_contingency(contagens)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>prop_test.pvalue</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>8.238913311602198e-26</code></pre>
</div>
</div>
<p>Nessa situação, o valor-p é muito baixo, então rejeitamos a hipótese nula e podemos afirmar que as proporções são diferentes. Note que, novamente, essa é a mesma conclusão que chegamos ao calcular o intervalo de confiança.</p>
<p>Existem situações, no entanto, que podemos ficar em dúvida. Vejamos um exemplo, agora com as câmaras 8 e 9</p>
<div id="cell-42" class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>exemplos_camaras <span class="op">=</span> [<span class="st">'06ª Câmara de Direito Criminal'</span>, <span class="st">'08ª Câmara de Direito Criminal'</span>]</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>camaras_filtrado <span class="op">=</span> (</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  camaras</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  .query(<span class="st">'polo_mp == "Passivo"'</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  .query(<span class="st">'camara == @exemplos_camaras'</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  .assign(negaram <span class="op">=</span> <span class="kw">lambda</span> x: x.decisao <span class="op">==</span> <span class="st">'Negaram'</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>proporcoes <span class="op">=</span> (</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  camaras_filtrado</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  .groupby(<span class="st">'camara'</span>)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  .agg(n <span class="op">=</span> (<span class="st">'decisao'</span>, <span class="bu">len</span>), n_negaram <span class="op">=</span> (<span class="st">'negaram'</span>, <span class="st">'sum'</span>), p <span class="op">=</span> (<span class="st">'negaram'</span>, <span class="st">'mean'</span>))</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  .reset_index(names<span class="op">=</span><span class="st">'camara'</span>)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>proporcoes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="98">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">camara</th>
<th data-quarto-table-cell-role="th">n</th>
<th data-quarto-table-cell-role="th">n_negaram</th>
<th data-quarto-table-cell-role="th">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>06ª Câmara de Direito Criminal</td>
<td>664</td>
<td>550</td>
<td>0.828313</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>08ª Câmara de Direito Criminal</td>
<td>635</td>
<td>447</td>
<td>0.703937</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Vejamos o valor do teste:</p>
<div id="cell-44" class="cell" data-execution_count="170">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>contagens <span class="op">=</span> np.array(proporcoes[[<span class="st">'n_negaram'</span>, <span class="st">'n'</span>]])</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>prop_test <span class="op">=</span> stats.chi2_contingency(contagens)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>prop_test.pvalue</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="170">
<pre><code>0.05950837666339642</code></pre>
</div>
</div>
<p>Agora, o valor-p, ou seja, a probabilidade dessa diferença ocorrer ao acaso é de 6%. Esse valor é baixo ou alto?</p>
<p>Nessas situações, precisamos estabelecer um valor de corte para o valor-p.&nbsp;Esse valor de corte é o <strong>nível de significância</strong>, que discutimos anteriormente na definição do teste de hipóteses. Esse valor é denotado por <span class="math inline">\(\alpha\)</span>. Por razões históricas, existe um valor de corte muito comum, que é 5%. Se o valor-p for menor que 5%, rejeitamos a hipótese nula. Se o valor-p for maior que 5%, não rejeitamos a hipótese nula. Essa é a “regra de bolso” usada em muitas áreas da ciência.</p>
<p>Nesse caso, então, a conclusão é que as proporções não são diferentes, porque o valor-p é maior que 5%.</p>
</section>
</section>
<section id="teste-para-várias-proporções" class="level3" data-number="7.3.4">
<h3 data-number="7.3.4" class="anchored" data-anchor-id="teste-para-várias-proporções"><span class="header-section-number">7.3.4</span> Teste para várias proporções</h3>
<p>E se nosso objetivo for comparar mais de duas proporções? Nesse caso, uma ideia inicial seria comparar cada par de proporções. Mas existe uma alternativa melhor, que é fazer um teste de hipóteses para todas as proporções ao mesmo tempo. Isso é feito com o teste de qui-quadrado.</p>
<p>O teste de qui-quadrado é um teste de hipóteses que compara a distribuição observada com a distribuição esperada. No caso de proporções, a distribuição observada é a proporção de casos em cada categoria, enquanto a distribuição esperada é a proporção de casos esperada se a hipótese nula fosse verdadeira.</p>
<p>Por exemplo, se quisermos comparar as proporções de negados, parcial procedente e procedente nas câmaras 3, 8 e 12, nossas hipóteses são:</p>
<p><span class="math inline">\(H_0\)</span>: a distribuição de decisões é a mesma nas três câmaras</p>
<p><span class="math inline">\(H_1\)</span>: a distribuição de decisões é diferente em alguma das câmaras</p>
<p>No python, podemos fazer o teste de qui-quadrado com a mesma função de antes: <code>chi2_contingency</code> do módulo <code>scipy.stats</code>. O retorno é uma tupla com a estatística de teste, o valor-p, o grau de liberdade e a tabela de contingência esperada.</p>
<div id="cell-47" class="cell" data-execution_count="248">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>exemplos_camaras <span class="op">=</span> [<span class="st">'03ª Câmara de Direito Criminal'</span>, <span class="st">'08ª Câmara de Direito Criminal'</span>, <span class="st">'12ª Câmara de Direito Criminal'</span>]</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>camaras_filtrado <span class="op">=</span> (</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  camaras</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  .query(<span class="st">'polo_mp == "Passivo"'</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  .query(<span class="st">'camara == @exemplos_camaras'</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  .query(<span class="st">'decisao == ["Negaram","Parcialmente","Provido"]'</span>)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>tabela_contingencia <span class="op">=</span> pd.crosstab(index<span class="op">=</span>camaras_filtrado[<span class="st">'camara'</span>], columns<span class="op">=</span>camaras_filtrado[<span class="st">'decisao'</span>])</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>tabela_contingencia</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="248">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">decisao</th>
<th data-quarto-table-cell-role="th">Negaram</th>
<th data-quarto-table-cell-role="th">Parcialmente</th>
<th data-quarto-table-cell-role="th">Provido</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">camara</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">03ª Câmara de Direito Criminal</td>
<td>358</td>
<td>140</td>
<td>10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">08ª Câmara de Direito Criminal</td>
<td>447</td>
<td>156</td>
<td>7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12ª Câmara de Direito Criminal</td>
<td>103</td>
<td>321</td>
<td>75</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Veja que as proporções são parecidas entre as câmaras 03 e 08, mas bem diferente na câmara 12:</p>
<div id="cell-49" class="cell" data-execution_count="254">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>tabela_contingencia.div(tabela_contingencia.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>), axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="254">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">decisao</th>
<th data-quarto-table-cell-role="th">Negaram</th>
<th data-quarto-table-cell-role="th">Parcialmente</th>
<th data-quarto-table-cell-role="th">Provido</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">camara</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">03ª Câmara de Direito Criminal</td>
<td>0.704724</td>
<td>0.275591</td>
<td>0.019685</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">08ª Câmara de Direito Criminal</td>
<td>0.732787</td>
<td>0.255738</td>
<td>0.011475</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12ª Câmara de Direito Criminal</td>
<td>0.206413</td>
<td>0.643287</td>
<td>0.150301</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Agora, procedemos com o teste:</p>
<div id="cell-51" class="cell" data-execution_count="255">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>chi2 <span class="op">=</span> stats.chi2_contingency(tabela_contingencia)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>chi2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="255">
<pre><code>Chi2ContingencyResult(statistic=403.3146570240564, pvalue=5.346841438716827e-86, dof=4, expected_freq=array([[285.25912183, 193.83797155,  28.90290662],
       [342.53555968, 232.75819419,  34.70624613],
       [280.20531849, 190.40383426,  28.39084725]]))</code></pre>
</div>
</div>
<p>Nesse objeto, temos os seguintes componentes:</p>
<ul>
<li>statistic: a estatística de teste, que é a base para o cálculo do valor-p</li>
<li>pvalue: o valor-p, que é a probabilidade de observar uma estatística de teste tão ou mais extrema quanto a observada, assumindo que a hipótese nula é verdadeira</li>
<li>dof: o grau de liberdade, que é o número de categorias menos um</li>
<li>expected: a tabela de contingência esperada, que é a distribuição esperada se a hipótese nula fosse verdadeira</li>
</ul>
<p>Nesse caso, o valor-p é muito baixo, então rejeitamos a hipótese nula e podemos afirmar que a distribuição de decisões é diferente em alguma das câmaras.</p>
</section>
<section id="teste-de-médias" class="level3" data-number="7.3.5">
<h3 data-number="7.3.5" class="anchored" data-anchor-id="teste-de-médias"><span class="header-section-number">7.3.5</span> Teste de médias</h3>
<p>Até agora, vimos o teste de proporções e o teste de uma tabela de contingência completa, que é um teste de proporções generalizado. Agora, vamos ver o teste de médias. A ideia é muito parecida com o que vimos antes, mas nesse caso utilizamos outra distribuição de probabilidades, a distribuição t de Student e, portanto, outra função do python, <code>ttest_ind</code> do módulo <code>scipy.stats</code>. Nos apêndices extras dessa apostila, temos uma explicação mais detalhada sobre a distribuição t de Student.</p>
<p>Para mostrar o teste de médias, vamos fazer um exemplo com a diferença de médias de idade entre relatores que vieram ou não do quinto constitucional. Nesse caso, nossas hipóteses são:</p>
<p><span class="math inline">\(H_0\)</span>: a média de idade dos relatores que vieram do quinto constitucional é igual à média de idade dos relatores que não vieram do quinto constitucional</p>
<p><span class="math inline">\(H_1\)</span>: a média de idade dos relatores que vieram do quinto constitucional é diferente da média de idade dos relatores que não vieram do quinto constitucional</p>
<div id="cell-55" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>relatores <span class="op">=</span> camaras.drop_duplicates(<span class="st">'relator'</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  relatores</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  .groupby(<span class="st">'rel_quinto'</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  .agg(n <span class="op">=</span> (<span class="st">'relator'</span>, <span class="bu">len</span>), media <span class="op">=</span> (<span class="st">'rel_idade'</span>, <span class="st">'mean'</span>), sd <span class="op">=</span> (<span class="st">'rel_idade'</span>, <span class="st">'std'</span>))</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  .reset_index(names<span class="op">=</span><span class="st">'rel_quinto'</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">rel_quinto</th>
<th data-quarto-table-cell-role="th">n</th>
<th data-quarto-table-cell-role="th">media</th>
<th data-quarto-table-cell-role="th">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>não</td>
<td>88</td>
<td>67.173987</td>
<td>5.911481</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>sim</td>
<td>21</td>
<td>65.910368</td>
<td>6.665895</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Olhando os dados, parece que a média de idades é bem parecida. Vamos fazer o gráfico com os intervalos de confiança:</p>
<div id="cell-57" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>sns.pointplot(data <span class="op">=</span> relatores, x <span class="op">=</span> <span class="st">'rel_quinto'</span>, y <span class="op">=</span> <span class="st">'rel_idade'</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>plt.axhline(<span class="fl">66.5</span>, color<span class="op">=</span><span class="st">'gray'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07-testes-hipoteses_files/figure-html/cell-28-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>De fato, os intervalos de confiança se sobrepõem. Vamos fazer o teste de hipóteses, usando a função <code>ttest_ind</code>:</p>
<div id="cell-59" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>ttest <span class="op">=</span> stats.ttest_ind(</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  relatores.rel_idade[relatores.rel_quinto <span class="op">==</span> <span class="st">'sim'</span>],</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  relatores.rel_idade[relatores.rel_quinto <span class="op">==</span> <span class="st">'não'</span>],</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  nan_policy<span class="op">=</span><span class="st">'omit'</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>ttest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>TtestResult(statistic=-0.8574885189308531, pvalue=0.3931095647661792, df=106.0)</code></pre>
</div>
</div>
<p>De fato, o valor-p ficou em 39%, então não rejeitamos a hipótese nula, ou seja, não há evidências para afirmar que as idades dos relatores que vieram do quinto constitucional são diferentes das idades dos relatores que não vieram do quinto constitucional.</p>
<p>Agora, vamos ver um exemplo em que as médias são diferentes. Vamos comparar a média de idade dos relatores que vieram da USP com a média de idade dos relatores que vieram de outras universidades. Nesse caso, nossas hipóteses são:</p>
<p><span class="math inline">\(H_0\)</span>: a média de idade dos relatores que vieram da USP é igual à média de idade dos relatores que vieram de outras universidades</p>
<p><span class="math inline">\(H_1\)</span>: a média de idade dos relatores que vieram da USP é diferente da média de idade dos relatores que vieram de outras universidades</p>
<p>Vamos fazer o gráfico com os intervalos de confiança:</p>
<div id="cell-61" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># o nome da faculdade de direito pode aparecer de diversas formas</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>usp <span class="op">=</span> [<span class="st">'Faculdade de Direito da Universidade de São Paulo'</span>, <span class="st">'Faculdade de Direto da Universidade de São Paulo'</span>, <span class="st">'Universidade de São Paulo'</span>]</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>relatores_usp <span class="op">=</span> (</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  relatores</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  .assign(usp <span class="op">=</span> <span class="kw">lambda</span> x: np.where(x.rel_faculdade_direito.isin(usp), <span class="st">'USP'</span>, <span class="st">'Outras'</span>))</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>sns.pointplot(data <span class="op">=</span> relatores_usp, x <span class="op">=</span> <span class="st">'usp'</span>, y <span class="op">=</span> <span class="st">'rel_idade'</span>)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>plt.axhline(<span class="fl">66.55</span>, color<span class="op">=</span><span class="st">'gray'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07-testes-hipoteses_files/figure-html/cell-30-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>É por muito pouco, mas parece que as médias são diferentes. Vamos fazer o teste de hipóteses:</p>
<div id="cell-63" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>ttest <span class="op">=</span> stats.ttest_ind(</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  relatores_usp.rel_idade[relatores_usp.usp <span class="op">==</span> <span class="st">'USP'</span>],</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  relatores_usp.rel_idade[<span class="op">~</span>(relatores_usp.usp <span class="op">==</span> <span class="st">'USP'</span>)],</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  nan_policy<span class="op">=</span><span class="st">'omit'</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>ttest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>TtestResult(statistic=-2.663336219551609, pvalue=0.00894402839660715, df=106.0)</code></pre>
</div>
</div>
<p>De fato, o valor-p ficou em 0.009, então rejeitamos a hipótese nula e podemos afirmar que a média de idade dos relatores que vieram da USP é diferente da média de idade dos relatores que vieram de outras universidades.</p>
<hr>
</section>
<section id="extra-simulação" class="level3" data-number="7.3.6">
<h3 data-number="7.3.6" class="anchored" data-anchor-id="extra-simulação"><span class="header-section-number">7.3.6</span> (extra) Simulação</h3>
<p>O que significa, na prática, a tal da “ocorrência ao acaso”? Vamos mostrar isso através de uma simulação. Vamos simular 1000 vezes a proporção de negados em duas câmaras. Para isso, no entanto, precisamos supor que a hipótese nula é verdadeira, ou seja, que as proporções são iguais. Vamos supor que a proporção das duas câmaras é 60%.</p>
<div id="cell-66" class="cell" data-execution_count="206">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> amostra_diferenca(prop1, prop2, n<span class="op">=</span><span class="dv">1000</span>):</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># faz uma amostra com os</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  camara1 <span class="op">=</span> np.random.choice([<span class="dv">0</span>,<span class="dv">1</span>], n, p<span class="op">=</span>[<span class="dv">1</span><span class="op">-</span>prop1,prop1])</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  camara2 <span class="op">=</span> np.random.choice([<span class="dv">0</span>,<span class="dv">1</span>], n, p<span class="op">=</span>[<span class="dv">1</span><span class="op">-</span>prop2,prop2])</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calcula a proporção</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  prop_camara1 <span class="op">=</span> camara1.mean()</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  prop_camara2 <span class="op">=</span> camara2.mean()</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># diferença entre câmaras</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  diferenca <span class="op">=</span> prop_camara1 <span class="op">-</span> prop_camara2</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  contagens <span class="op">=</span> np.array([[camara1.<span class="bu">sum</span>(), camara2.<span class="bu">sum</span>()], [n<span class="op">-</span>camara1.<span class="bu">sum</span>(), n<span class="op">-</span>camara2.<span class="bu">sum</span>()]])</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  valor_p <span class="op">=</span> stats.chi2_contingency(contagens).pvalue</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'prop1'</span>: prop_camara1,</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'prop2'</span>: prop_camara2,</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'diferenca'</span>: diferenca,</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'valor_p'</span>: valor_p</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>  }, index<span class="op">=</span>[<span class="dv">0</span>])</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-67" class="cell" data-execution_count="208">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>amostra_diferenca(<span class="fl">0.6</span>, <span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="208">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">prop1</th>
<th data-quarto-table-cell-role="th">prop2</th>
<th data-quarto-table-cell-role="th">diferenca</th>
<th data-quarto-table-cell-role="th">valor_p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.602</td>
<td>0.628</td>
<td>-0.026</td>
<td>0.250625</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>vamos fazer essa conta mil vezes:</p>
<div id="cell-69" class="cell" data-execution_count="209">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>amostras <span class="op">=</span> []</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1000</span>):</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  amostras.append(amostra_diferenca(<span class="fl">0.6</span>, <span class="fl">0.6</span>))</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.concat(amostras)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="209">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">prop1</th>
<th data-quarto-table-cell-role="th">prop2</th>
<th data-quarto-table-cell-role="th">diferenca</th>
<th data-quarto-table-cell-role="th">valor_p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.589</td>
<td>0.609</td>
<td>-0.020</td>
<td>0.386014</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>0.579</td>
<td>0.610</td>
<td>-0.031</td>
<td>0.171856</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.582</td>
<td>0.603</td>
<td>-0.021</td>
<td>0.362750</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>0.590</td>
<td>0.592</td>
<td>-0.002</td>
<td>0.963724</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.605</td>
<td>0.601</td>
<td>0.004</td>
<td>0.890948</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.613</td>
<td>0.616</td>
<td>-0.003</td>
<td>0.926790</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>0.595</td>
<td>0.584</td>
<td>0.011</td>
<td>0.649429</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.587</td>
<td>0.600</td>
<td>-0.013</td>
<td>0.584865</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>0.583</td>
<td>0.595</td>
<td>-0.012</td>
<td>0.617133</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.599</td>
<td>0.606</td>
<td>-0.007</td>
<td>0.783969</td>
</tr>
</tbody>
</table>

<p>1000 rows × 4 columns</p>
</div>
</div>
</div>
<p>Agora, fazemos um histograma das diferenças:</p>
<div id="cell-71" class="cell" data-execution_count="210">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>sns.histplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">'diferenca'</span>, kde<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>plt.axvline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'gray'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07-testes-hipoteses_files/figure-html/cell-35-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Veja como, nesse caso, a diferença fica centrada no zero. Nessa simulação, se extrairmos os quantis de 2,5% e 97,5%, temos o intervalo de confiança simulado para essa diferença. Veja que ela contém o zero:</p>
<div id="cell-73" class="cell" data-execution_count="186">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>np.quantile(df.diferenca, [<span class="fl">0.025</span>, <span class="fl">0.975</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="186">
<pre><code>array([-0.041025,  0.041   ])</code></pre>
</div>
</div>
<p>E veja que interessante, a proporção de vezes em que, ao fazer o teste de hipóteses, rejeitaríamos a hipótese nula:</p>
<div id="cell-75" class="cell" data-execution_count="212">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>(df.valor_p <span class="op">&lt;</span> <span class="fl">0.05</span>).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="212">
<pre><code>0.053</code></pre>
</div>
</div>
<p>Ou seja, em aproximadamente 5% das amostras, nós rejeitaríamos a hipótese nula, mesmo ela sendo verdadeira. Isso é o erro do tipo I, que é o nível de significância que escolhemos.</p>
<p>Agora, vamos para um exemplo onde as proporções são diferentes, 60% e 70%:</p>
<div id="cell-78" class="cell" data-execution_count="213">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>amostras <span class="op">=</span> []</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1000</span>):</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  amostras.append(amostra_diferenca(<span class="fl">0.7</span>, <span class="fl">0.6</span>))</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.concat(amostras)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="213">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">prop1</th>
<th data-quarto-table-cell-role="th">prop2</th>
<th data-quarto-table-cell-role="th">diferenca</th>
<th data-quarto-table-cell-role="th">valor_p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.702</td>
<td>0.605</td>
<td>0.097</td>
<td>6.449431e-06</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>0.698</td>
<td>0.586</td>
<td>0.112</td>
<td>2.251830e-07</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.671</td>
<td>0.611</td>
<td>0.060</td>
<td>5.956293e-03</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>0.732</td>
<td>0.582</td>
<td>0.150</td>
<td>2.243348e-12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.695</td>
<td>0.614</td>
<td>0.081</td>
<td>1.686924e-04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.689</td>
<td>0.597</td>
<td>0.092</td>
<td>2.166091e-05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>0.700</td>
<td>0.606</td>
<td>0.094</td>
<td>1.250206e-05</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.696</td>
<td>0.596</td>
<td>0.100</td>
<td>3.671498e-06</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>0.691</td>
<td>0.592</td>
<td>0.099</td>
<td>4.889018e-06</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.681</td>
<td>0.614</td>
<td>0.067</td>
<td>2.007758e-03</td>
</tr>
</tbody>
</table>

<p>1000 rows × 4 columns</p>
</div>
</div>
</div>
<p>O histograma fica assim:</p>
<div id="cell-80" class="cell" data-execution_count="214">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>sns.histplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">'diferenca'</span>, kde<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>plt.axvline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'gray'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07-testes-hipoteses_files/figure-html/cell-39-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>E o intervalo de confiança simulado fica assim:</p>
<div id="cell-82" class="cell" data-execution_count="215">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>np.quantile(df.diferenca, [<span class="fl">0.025</span>, <span class="fl">0.975</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="215">
<pre><code>array([0.059975, 0.141   ])</code></pre>
</div>
</div>
<p>Veja que dessa vez o intervalo não contém o zero. Ou seja, a diferença é estatisticamente diferente de zero.</p>
<p>Agora, veja a proporção de vezes que o valor-p é menor de 5%:</p>
<div id="cell-85" class="cell" data-execution_count="216">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>(df.valor_p <span class="op">&lt;</span> <span class="fl">0.05</span>).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="216">
<pre><code>1.0</code></pre>
</div>
</div>
<p>Todas as vezes! Ou seja, em 100% das amostras, rejeitaríamos a hipótese nula, o que é esperado, já que ela é falsa.</p>
<p>Agora vamos para um exemplo onde as proporções são diferentes, mas não muito, 60% e 62%:</p>
<div id="cell-88" class="cell" data-execution_count="217">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>amostras <span class="op">=</span> []</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1000</span>):</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  amostras.append(amostra_diferenca(<span class="fl">0.62</span>, <span class="fl">0.60</span>))</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.concat(amostras)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="217">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">prop1</th>
<th data-quarto-table-cell-role="th">prop2</th>
<th data-quarto-table-cell-role="th">diferenca</th>
<th data-quarto-table-cell-role="th">valor_p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.623</td>
<td>0.615</td>
<td>0.008</td>
<td>0.747217</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>0.611</td>
<td>0.584</td>
<td>0.027</td>
<td>0.235815</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.625</td>
<td>0.614</td>
<td>0.011</td>
<td>0.645114</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>0.599</td>
<td>0.594</td>
<td>0.005</td>
<td>0.855337</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.650</td>
<td>0.625</td>
<td>0.025</td>
<td>0.264270</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.644</td>
<td>0.609</td>
<td>0.035</td>
<td>0.116030</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>0.625</td>
<td>0.604</td>
<td>0.021</td>
<td>0.358177</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.618</td>
<td>0.599</td>
<td>0.019</td>
<td>0.409579</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>0.625</td>
<td>0.601</td>
<td>0.024</td>
<td>0.291009</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.592</td>
<td>0.591</td>
<td>0.001</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

<p>1000 rows × 4 columns</p>
</div>
</div>
</div>
<p>O histograma fica assim:</p>
<div id="cell-90" class="cell" data-execution_count="218">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>sns.histplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">'diferenca'</span>, kde<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>plt.axvline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'gray'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07-testes-hipoteses_files/figure-html/cell-43-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>E o intervalo de confiança simulado fica assim:</p>
<div id="cell-92" class="cell" data-execution_count="219">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>np.quantile(df.diferenca, [<span class="fl">0.025</span>, <span class="fl">0.975</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="219">
<pre><code>array([-0.022,  0.065])</code></pre>
</div>
</div>
<p>Veja que dessa vez o intervalo não contém o zero. Ou seja, a diferença é estatisticamente diferente de zero.</p>
<p>Agora, veja a proporção de vezes que o valor-p é menor de 5%:</p>
<div id="cell-95" class="cell" data-execution_count="220">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>(df.valor_p <span class="op">&lt;</span> <span class="fl">0.05</span>).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="220">
<pre><code>0.15</code></pre>
</div>
</div>
<p>Nesse caso, não há evidências suficientes para rejeitar a hipótese nula. Isso é o que ocorre quando temos uma diferença na população que é muito pequena. Mas tem um jeito de detectar essa diferença, que é aumentando o tamanho da amostra. Vamos ver isso. Considere que, ao invés de 1000 observações, temos 5000:</p>
<div id="cell-97" class="cell" data-execution_count="239">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>amostras <span class="op">=</span> []</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1000</span>):</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  amostras.append(amostra_diferenca(<span class="fl">0.62</span>, <span class="fl">0.60</span>, <span class="dv">5000</span>))</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.concat(amostras)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="239">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">prop1</th>
<th data-quarto-table-cell-role="th">prop2</th>
<th data-quarto-table-cell-role="th">diferenca</th>
<th data-quarto-table-cell-role="th">valor_p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.6302</td>
<td>0.5914</td>
<td>0.0388</td>
<td>0.000075</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>0.6274</td>
<td>0.6010</td>
<td>0.0264</td>
<td>0.007121</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.6206</td>
<td>0.5982</td>
<td>0.0224</td>
<td>0.022898</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>0.6198</td>
<td>0.6014</td>
<td>0.0184</td>
<td>0.062009</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.6196</td>
<td>0.5982</td>
<td>0.0214</td>
<td>0.029845</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.6194</td>
<td>0.6086</td>
<td>0.0108</td>
<td>0.276297</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>0.6134</td>
<td>0.6060</td>
<td>0.0074</td>
<td>0.460526</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.6222</td>
<td>0.5976</td>
<td>0.0246</td>
<td>0.012379</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>0.6134</td>
<td>0.6092</td>
<td>0.0042</td>
<td>0.681590</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.6146</td>
<td>0.6072</td>
<td>0.0074</td>
<td>0.460276</td>
</tr>
</tbody>
</table>

<p>1000 rows × 4 columns</p>
</div>
</div>
</div>
<p>O histograma fica assim:</p>
<div id="cell-99" class="cell" data-execution_count="240">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>sns.histplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">'diferenca'</span>, kde<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>plt.axvline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'gray'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07-testes-hipoteses_files/figure-html/cell-47-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>E o intervalo de confiança simulado fica assim:</p>
<div id="cell-101" class="cell" data-execution_count="241">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>np.quantile(df.diferenca, [<span class="fl">0.025</span>, <span class="fl">0.975</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="241">
<pre><code>array([0.0018, 0.0388])</code></pre>
</div>
</div>
<p>Veja que dessa vez o intervalo não contém o zero. Ou seja, a diferença é estatisticamente diferente de zero.</p>
<p>Agora, veja a proporção de vezes que o valor-p é menor de 5%:</p>
<div id="cell-104" class="cell" data-execution_count="243">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>(df.valor_p <span class="op">&lt;</span> <span class="fl">0.05</span>).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="243">
<pre><code>0.536</code></pre>
</div>
</div>
<p>Veja que em mais da metade das amostras que fizemos, o valor-p foi menor de 5%.</p>
<p>Essas simulações mostram como o valor-p é uma medida de quão extremo é o resultado observado. Se a diferença entre as proporções for muito pequena, o valor-p será alto, indicando que a diferença pode ter ocorrido por acaso. Se a diferença for grande, o valor-p será baixo, indicando que a diferença é estatisticamente significante.</p>
<hr>
</section>
<section id="extra-por-que-usamos-t-student" class="level3" data-number="7.3.7">
<h3 data-number="7.3.7" class="anchored" data-anchor-id="extra-por-que-usamos-t-student"><span class="header-section-number">7.3.7</span> (extra) por que usamos t-student?</h3>
<p>Na apostila anterior e no início dessa apostila, vimos intevalos de confiança baseados no valor de <span class="math inline">\(z_{1-\alpha/2}\)</span>.</p>
<p>Nos livros didáticos, o que temos é que esse valor <span class="math inline">\(z\)</span> é usado quando a <strong>variância populacional (<span class="math inline">\(\sigma^2\)</span>) é conhecida</strong>, enquanto, quando a variância populacional é desconhecida, usamos o valor <span class="math inline">\(t\)</span>, da distribuição t-Student. É daí que vem o termo “teste t”, que são os testes que usam a distribuição t-Student no lugar da distribuição normal.</p>
<p>A origem disso está na suposição sobre a <strong>distribuição de probabilidades da variável</strong> de interesse. Quando supomos que a variável de interesse é normal, existe um resultado mostrando que a média amostral (<span class="math inline">\(\bar X\)</span>) dividida pelo desvio padrão amostral (<span class="math inline">\(S\)</span>) e multiplicada por uma constante <strong>segue uma distribuição t de Student</strong>. Essa constante é chamada de <strong>graus de liberdade</strong> e no caso que estamos estudando é dada por <span class="math inline">\(n-1\)</span>, onde <span class="math inline">\(n\)</span> é o tamanho da amostra.</p>
<p>Vamos desenhar a t-student para alguns valores de <span class="math inline">\(n\)</span>, comparando-a com a distribuição normal.</p>
<div id="cell-107" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>valores_n <span class="op">=</span> [<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>]</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">1000</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'x'</span>: x, <span class="st">'densidade'</span>: stats.norm.pdf(x)})</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="co"># mostrando a distribuição t-student para os diferentes valores de n</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.assign(t_pdf <span class="op">=</span> stats.t.pdf(x, df <span class="op">=</span> valores_n[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">1</span>))</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="co"># mostrando o gráfico da normal</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>sns.lineplot(ax <span class="op">=</span> axes[<span class="dv">0</span>,<span class="dv">0</span>], data <span class="op">=</span> df, x <span class="op">=</span> <span class="st">'x'</span>, y <span class="op">=</span> <span class="st">"densidade"</span>, label<span class="op">=</span><span class="st">"Normal"</span>)</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a><span class="co"># mostrando o gráfico da t-student</span></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>sns.lineplot(ax <span class="op">=</span> axes[<span class="dv">0</span>,<span class="dv">0</span>], data <span class="op">=</span> df, x <span class="op">=</span> <span class="st">'x'</span>, y <span class="op">=</span> <span class="st">'t_pdf'</span>, label<span class="op">=</span><span class="st">"t-student"</span>)</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.assign(t_pdf <span class="op">=</span> stats.t.pdf(x, df <span class="op">=</span> valores_n[<span class="dv">1</span>] <span class="op">-</span> <span class="dv">1</span>))</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>sns.lineplot(ax <span class="op">=</span> axes[<span class="dv">0</span>,<span class="dv">1</span>], data <span class="op">=</span> df, x <span class="op">=</span> <span class="st">'x'</span>, y <span class="op">=</span> <span class="st">"densidade"</span>, label<span class="op">=</span><span class="st">"Normal"</span>)</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>sns.lineplot(ax <span class="op">=</span> axes[<span class="dv">0</span>,<span class="dv">1</span>], data <span class="op">=</span> df, x <span class="op">=</span> <span class="st">'x'</span>, y <span class="op">=</span> <span class="st">'t_pdf'</span>, label<span class="op">=</span><span class="st">"t-student"</span>)</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.assign(t_pdf <span class="op">=</span> stats.t.pdf(x, df <span class="op">=</span> valores_n[<span class="dv">2</span>] <span class="op">-</span> <span class="dv">1</span>))</span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>sns.lineplot(ax <span class="op">=</span> axes[<span class="dv">1</span>,<span class="dv">0</span>], data <span class="op">=</span> df, x <span class="op">=</span> <span class="st">'x'</span>, y <span class="op">=</span> <span class="st">"densidade"</span>, label<span class="op">=</span><span class="st">"Normal"</span>)</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>sns.lineplot(ax <span class="op">=</span> axes[<span class="dv">1</span>,<span class="dv">0</span>], data <span class="op">=</span> df, x <span class="op">=</span> <span class="st">'x'</span>, y <span class="op">=</span> <span class="st">'t_pdf'</span>, label<span class="op">=</span><span class="st">"t-student"</span>)</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.assign(t_pdf <span class="op">=</span> stats.t.pdf(x, df <span class="op">=</span> valores_n[<span class="dv">3</span>] <span class="op">-</span> <span class="dv">1</span>))</span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a>sns.lineplot(ax <span class="op">=</span> axes[<span class="dv">1</span>,<span class="dv">1</span>], data <span class="op">=</span> df, x <span class="op">=</span> <span class="st">'x'</span>, y <span class="op">=</span> <span class="st">"densidade"</span>, label<span class="op">=</span><span class="st">"Normal"</span>)</span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a>sns.lineplot(ax <span class="op">=</span> axes[<span class="dv">1</span>,<span class="dv">1</span>], data <span class="op">=</span> df, x <span class="op">=</span> <span class="st">'x'</span>, y <span class="op">=</span> <span class="st">'t_pdf'</span>, label<span class="op">=</span><span class="st">"t-student"</span>)</span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07-testes-hipoteses_files/figure-html/cell-50-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Veja que para valores pequenos de <span class="math inline">\(n\)</span>, a t-student é mais larga que a distribuição normal. Isso ocorre porque a variância amostral é uma estimativa da variância populacional e, portanto, é mais incerta. Conforme o tamanho da amostra aumenta, a t-student se aproxima da distribuição normal.</p>
<p>Portanto, o t-score é usado quando temos a suposição de normalidade e é mais útil quando temos poucos dados, já que, quando temos muitos dados, os números são quase equivalentes ao z-score.</p>
<p>Já o z-score pode ser usado em <strong>duas situações</strong>:</p>
<ol type="1">
<li><p>quando assumimos que a variável de interesse tem distribuição normal e variância conhecida (portanto, não temos a razão entre a média e o desvio padrão amostrais), ou</p></li>
<li><p>quando a variavel de interesse não é normal e usamos o TCL para aproximar a distribuição amostral da média. Neste segundo caso, existe um teorema adicional, chamado <a href="https://en.wikipedia.org/wiki/Slutsky%27s_theorem">teorema de Slutsky</a>, que, a partir do resultado de que o desvio padrão amostral converge em probabilidade para o desvio padrão da população, mostra que o z-score é assintoticamente normal.</p></li>
</ol>
<p>Por isso que dizemos que o z-score é usado quando a variância populacional é conhecida ou quando o tamanho da amostra é grande. Se não, supomos que a variável de interesse é normal e usamos o t-score.</p>
<section id="aplicação-no-python-2" class="level4" data-number="7.3.7.1">
<h4 data-number="7.3.7.1" class="anchored" data-anchor-id="aplicação-no-python-2"><span class="header-section-number">7.3.7.1</span> Aplicação no python</h4>
<p>No python, podemos fazer o intervalo de confiança com t-score fazendo as seguintes operações:</p>
<div id="cell-109" class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>tempos <span class="op">=</span> camaras.tempo</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>media <span class="op">=</span> tempos.mean()</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>sd <span class="op">=</span> tempos.std()</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> stats.norm.ppf(<span class="fl">0.975</span>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>tscore <span class="op">=</span> stats.t.ppf(<span class="fl">0.975</span>, df <span class="op">=</span> <span class="bu">len</span>(tempos) <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">len</span>(tempos)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>vl_intervalo_t <span class="op">=</span> tscore <span class="op">*</span> sd <span class="op">/</span> np.sqrt(n)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>media <span class="op">-</span> vl_intervalo_t, media <span class="op">+</span> vl_intervalo_t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(3.1360526281801846, 3.2216300942330562)</code></pre>
</div>
</div>
<p>Como nossa amostra é grande, o resultado é praticamente o mesmo. Vamos ver com uma amostra pequena, comparando com o z-score:</p>
<div id="cell-111" class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>tempos <span class="op">=</span> camaras.sample(<span class="dv">20</span>, random_state<span class="op">=</span><span class="dv">42</span>).tempo</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>media <span class="op">=</span> tempos.mean()</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>sd <span class="op">=</span> tempos.std()</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> stats.norm.ppf(<span class="fl">0.975</span>)</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>tscore <span class="op">=</span> stats.t.ppf(<span class="fl">0.975</span>, df <span class="op">=</span> <span class="bu">len</span>(tempos) <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">len</span>(tempos)</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>vl_intervalo_z <span class="op">=</span> z <span class="op">*</span> sd <span class="op">/</span> np.sqrt(n)</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>vl_intervalo_t <span class="op">=</span> tscore <span class="op">*</span> sd <span class="op">/</span> np.sqrt(n)</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(media <span class="op">-</span> vl_intervalo_z, media <span class="op">+</span> vl_intervalo_z)</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(media <span class="op">-</span> vl_intervalo_t, media <span class="op">+</span> vl_intervalo_t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2.037385709232428 4.425311073792897
1.9563287310545743 4.5063680519707505</code></pre>
</div>
</div>
<p>Veja como o intervalo de confiança da normal é mais “otimista” do que o intervalo de confiança da t-student. Isso ocorre porque a t-student é mais larga, refletindo a incerteza adicional devido à variância amostral, enquanto a normal é mais estreita e faz uso de teoremas de convergência para aproximar a distribuição amostral da média.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./06-probabilidade-cnormal.html" class="pagination-link" aria-label="Probabilidade e curva normal">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Probabilidade e curva normal</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./08-correlacao-regressao.html" class="pagination-link" aria-label="Correlação e regressão">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Correlação e regressão</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>